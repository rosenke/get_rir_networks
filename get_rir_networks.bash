#!/bin/bash

# Purpose:	get RIR networks from official IANA file
# Usage:	get_rir_networks.bash
# Example:	get_rir_networks.bash
# Responsible:	Stephan Rosenke <r01-571@r0s.de>
# License:	CC BY-SA 4.0
# Version:	2017-07-25
# Based on:	n/a

################################################################################
# set some user serviceable vars                                               #
################################################################################
csv_url="https://www.iana.org/assignments/ipv4-address-space/ipv4-address-space.csv"
rirs="AFRINIC APNIC ARIN LACNIC RIPE"

################################################################################
################################################################################
######################### DON'T MESS BEHIND THIS LINE ##########################
################################################################################
################################################################################

################################################################################
# set some non-user serviceable vars                                           #
################################################################################
csv_local="./ipv4-address-space.csv"

# unset LANG if you parse stdout-put of your commands for preventing problems
# with unanticipated languages
unset LANG


################################################################################
# define some functions                                                        #
################################################################################
#n/a


################################################################################
################################################################################
##################################### Main #####################################
################################################################################
################################################################################

# get CSV file with address assignments and save it locally
wget --progress=dot --output-document "${csv_local}" "${csv_url}"

# main loop over $rirs
for i in ${rirs} ; do
 # extract each RIR network
 egrep "${i}" "${csv_local}" | cut -d ',' -f 1 | \
  sed -re 's/^0+//;s/\/8$/.0.0.0&/' >"${i}.txt"
done

#cleanup
#n/a


################################################################################
##################################### EOF ######################################
################################################################################

